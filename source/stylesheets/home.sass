+keyframes(welcome-text)
  0%
    opacity: 0

  100%
    +transform(none)
    opacity: 1

+keyframes(hide-welcome-text)
  0%
    opacity: 1

  100%
    opacity: 0

.welcome_image
  background: var(--header-background-color)
  color: var(--welcome-text-color)
  height: 100vh
  height: 100svh
  left: 0
  position: relative
  text-align: center
  top: calc(var(--header-height) * -1)
  width: 100%
  display: flex
  align-items: center
  z-index: 2
  flex-shrink: 0
  overflow: hidden

  .carousel
    height: 100%

  .home-carousel
    transition: opacity .3s ease-in
    position: absolute
    top: 0
    left: 0
    width: 100%
    height: 100%
    opacity: 0

    img
      object-fit: cover
      width: 100%
      height: 100%

    .splide__slide.slideshow-clickable
      cursor: pointer

  .splide__pagination
    bottom: 24px
    z-index: 5
    gap: 4px

    li
      height: 24px
      width: 24px

    button
      background: transparent
      border: 2px solid var(--welcome-text-color)
      cursor: pointer
      height: 14px
      margin: 8px
      opacity: .5
      width: 14px

      &:hover
        opacity: 1

      &.is-active
        background: var(--welcome-text-color)
        opacity: 1
        transform: none

  .welcome_overlay
    background-color: var(--overlay-background-color)
    content: ""
    height: 100%
    position: absolute
    top: 0
    width: 100%
    z-index: 1
    pointer-events: none
    // Background color based on brightening or darkening
    background: #{"{% if theme.featured_overlay_opacity == 'very_bright' or theme.featured_overlay_opacity == 'bright' %} white {% else %} black {% endif %}"}
    // Handle each specific case
    opacity: 0
    opacity: #{"{% if theme.featured_overlay_opacity == 'very_bright' %} 0.8 {% endif %}"}
    opacity: #{"{% if theme.featured_overlay_opacity == 'bright' %} 0.3 {% endif %}"}
    opacity: #{"{% if theme.featured_overlay_opacity == 'dark' %} 0.4 {% endif %}"}
    opacity: #{"{% if theme.featured_overlay_opacity == 'very_dark' %} 0.7 {% endif %}"}

  .welcome_text
    position: relative
    +animation(welcome-text ease-in 900ms forwards)
    padding: 0 20px
    max-width: 1200px
    margin: 0 auto
    z-index: 2

    &.fade_out
      +animation(hide-welcome-text ease-in 200ms forwards)

  .welcome-subheader
    +fluid-type(16px, 20px)
    font-family: var(--header-font)
    font-weight: 600
    letter-spacing: .2em
    line-height: 1.25em
    margin-right: -.2em
    padding: 0 16px 24px 16px
    text-transform: uppercase

    @media only screen and (max-width: $breakpoint-small)
      letter-spacing: .1em
      margin-right: -.1em

  .welcome-header
    +fluid-type(20px, 60px)
    font-family: var(--header-font)
    font-weight: bold
    letter-spacing: .2em
    line-height: 1.3em
    margin: 0 -.2em 24px 0
    text-transform: uppercase

    @media only screen and (max-width: $breakpoint-small)
      letter-spacing: .1em
      padding: 0 16px
      white-space: normal

  a.welcome_button
    +transition(background .2s linear, border .2s linear)
    border: 1px solid var(--welcome-text-color)
    background: transparent
    color: var(--welcome-text-color)
    height: auto
    display: inline-flex
    padding: $marginSize / 2 $marginSize
    width: auto

    &:hover, &:focus
      border: 1px solid var(--button-background-hover-color)
      background: var(--button-background-hover-color)
      color: var(--button-text-color)

.welcome_image + main
  margin-top: calc(var(--header-height) * -1)

a.button.view-all-products
  border: 1px solid var(--link-color)
  color: var(--link-color)
  display: block
  max-width: 240px
  width: 48%
  margin: 40px auto

  &:hover, &:focus
    border-color: var(--link-hover-color)
    color: var(--link-hover-color)

  @media screen and (max-width: $breakpoint-small)
    margin-top: 32px

#home h1
  margin-bottom: #{"{% if theme.featured_subheader == blank %} 48px {% else %} 16px {% endif %}"}

#main 
  .featured-container
    margin: 20px auto 40px auto
    max-width: 1024px

  .featured-title
    margin-bottom: 0

    @media screen and (max-width: $breakpoint-small)
      font-size: 1.5rem

  .featured-message
    text-align: center
    margin: 20px auto 40px auto
    padding: 0 1.5rem

    ol, ul
      text-align: left
      margin: 1em auto
      max-width: 600px
      padding-left: 2.5em

      ol, ul
        margin: 0.5em 0
        padding-left: 1.5em

    ul
      list-style: disc

    ol
      list-style: decimal

    a
      text-decoration: underline
      text-underline-offset: 3px

    img
      display: inline-block
      max-width: 100%
      margin: 0 auto
      padding-bottom: 16px
    
    iframe
      display: block
      margin: 0 auto
      max-width: 100%
      margin-bottom: 16px

// Featured Categories
.featured-container--with-spacing
  margin-top: 64px

#main .featured-container--with-spacing
  // Override the generic #main .featured-container max-width (1024px)
  // so categories grid matches products grid width
  max-width: $breakpoint-large

#main .featured-container--with-spacing .featured-title
  margin-bottom: 32px

.category-count
  margin-top: 4px
  opacity: .9
  font-size: 0.9em
  color: var(--body-text-color)

.all-products-button
  margin-top: 32px